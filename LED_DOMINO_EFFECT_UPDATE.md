# Slave ë³´ë“œ LED ë„ë¯¸ë…¸ íš¨ê³¼ ì„¤ì • ì™„ë£Œ

## ğŸ“‹ **ìµœì¢… LED ì„¤ì •**

### ğŸ”§ **ë¬¸ì œì œì‹œ LED (Problem LED)**
- **í•˜ë“œì›¨ì–´**: MCP23017 #1 (I2C ì£¼ì†Œ: 0x20)
- **í¬íŠ¸**: GPIOA
- **ì‚¬ìš© ë¹„íŠ¸**: 4, 5, 6, 7ë²ˆ ë¹„íŠ¸
- **LED ê°œìˆ˜**: 4ê°œ
- **ë¹„íŠ¸ ë§ˆìŠ¤í¬**: 0xF0 (11110000)

```
ë¬¸ì œ LED 1ë²ˆ: GPIOA ë¹„íŠ¸ 4
ë¬¸ì œ LED 2ë²ˆ: GPIOA ë¹„íŠ¸ 5  
ë¬¸ì œ LED 3ë²ˆ: GPIOA ë¹„íŠ¸ 6
ë¬¸ì œ LED 4ë²ˆ: GPIOA ë¹„íŠ¸ 7
```

### ğŸ¯ **ì ìˆ˜ LED (Score LED)**
- **í•˜ë“œì›¨ì–´**: MCP23017 #2 (I2C ì£¼ì†Œ: 0x21)
- **í¬íŠ¸**: GPIOA
- **ì‚¬ìš© ë¹„íŠ¸**: 0, 1, 2, 3, 4, 5ë²ˆ ë¹„íŠ¸
- **LED ê°œìˆ˜**: 6ê°œ
- **ë¹„íŠ¸ ë§ˆìŠ¤í¬**: 0x3F (00111111)

```
ì ìˆ˜ LED 1ë²ˆ: GPIOA ë¹„íŠ¸ 0
ì ìˆ˜ LED 2ë²ˆ: GPIOA ë¹„íŠ¸ 1
ì ìˆ˜ LED 3ë²ˆ: GPIOA ë¹„íŠ¸ 2
ì ìˆ˜ LED 4ë²ˆ: GPIOA ë¹„íŠ¸ 3
ì ìˆ˜ LED 5ë²ˆ: GPIOA ë¹„íŠ¸ 4
ì ìˆ˜ LED 6ë²ˆ: GPIOA ë¹„íŠ¸ 5
```

## ğŸ‰ **7ì  í´ë¦¬ì–´ ë„ë¯¸ë…¸ íš¨ê³¼**

### âœ¨ **íš¨ê³¼ ì„¤ëª…**
7ì  ë‹¬ì„± ì‹œ:
- 6ê°œì˜ ì ìˆ˜ LEDê°€ **ë„ë¯¸ë…¸ì²˜ëŸ¼ ìˆœì„œëŒ€ë¡œ ì ë“±**
- **0.5ì´ˆ ê°„ê²©**ìœ¼ë¡œ ì§„í–‰
- **ì˜¤ë¦„ì°¨ìˆœ â†’ ë‚´ë¦¼ì°¨ìˆœ** íŒ¨í„´ì„ **2íšŒ ë°˜ë³µ**
- ìµœì¢…ì ìœ¼ë¡œ ëª¨ë“  LED ì ë“±í•˜ì—¬ í´ë¦¬ì–´ í‘œì‹œ

### ğŸ”„ **ë„ë¯¸ë…¸ íŒ¨í„´**
```
ì‚¬ì´í´ 1:
  ì˜¤ë¦„ì°¨ìˆœ: LED1 â†’ LED2 â†’ LED3 â†’ LED4 â†’ LED5 â†’ LED6
  ë‚´ë¦¼ì°¨ìˆœ: LED6 â†’ LED5 â†’ LED4 â†’ LED3 â†’ LED2 â†’ LED1

ì‚¬ì´í´ 2:
  ì˜¤ë¦„ì°¨ìˆœ: LED1 â†’ LED2 â†’ LED3 â†’ LED4 â†’ LED5 â†’ LED6
  ë‚´ë¦¼ì°¨ìˆœ: LED6 â†’ LED5 â†’ LED4 â†’ LED3 â†’ LED2 â†’ LED1

ìµœì¢…: ëª¨ë“  LED ë™ì‹œ ì ë“± (í´ë¦¬ì–´ í‘œì‹œ)
```

## ğŸ”§ **ìˆ˜ì •ëœ íŒŒì¼ë“¤**

### 1. **include/slave_config.h**
```cpp
// LED ìƒìˆ˜ ë° ë¹„íŠ¸ ë§¤í•‘
#define PROBLEM_LED_COUNT 4
#define SCORE_LED_COUNT 6
#define PROBLEM_LED_START_BIT 4
#define PROBLEM_LED_MASK 0xF0
#define SCORE_LED_START_BIT 0
#define SCORE_LED_MASK 0x3F

// ë„ë¯¸ë…¸ íš¨ê³¼ ì„¤ì •
#define CLEAR_DOMINO_INTERVAL 500  // 0.5ì´ˆ ê°„ê²©
#define CLEAR_DOMINO_CYCLES 2      // 2íšŒ ë°˜ë³µ

// ScoreLEDState êµ¬ì¡°ì²´ì— ë„ë¯¸ë…¸ íš¨ê³¼ í•„ë“œ ì¶”ê°€
struct ScoreLEDState {
  // ê¸°ì¡´ í•„ë“œë“¤...
  bool dominoActive;        // ë„ë¯¸ë…¸ íš¨ê³¼ í™œì„±í™” ìƒíƒœ
  uint8_t dominoStep;       // í˜„ì¬ ë„ë¯¸ë…¸ ë‹¨ê³„ (0~5)
  bool dominoDirection;     // true: ì˜¤ë¦„ì°¨ìˆœ, false: ë‚´ë¦¼ì°¨ìˆœ
  uint8_t dominoCycle;      // í˜„ì¬ ì‚¬ì´í´ (0~1)
  unsigned long dominoTimer; // ë„ë¯¸ë…¸ íƒ€ì´ë¨¸
};

// ìƒˆë¡œìš´ í•¨ìˆ˜ ì„ ì–¸
void startClearDominoEffect();
void updateClearDominoEffect();
```

### 2. **src/slave/main.cpp**

#### ğŸ”„ **ìˆ˜ì •ëœ í•¨ìˆ˜ë“¤**

**displayScore()**
```cpp
void displayScore(uint8_t score) {
  // 7ì  ë‹¬ì„± ì‹œ ë„ë¯¸ë…¸ íš¨ê³¼ ì‹œì‘
  if (score >= 7) {
    startClearDominoEffect();
    return;
  }
  
  // ì¼ë°˜ ì ìˆ˜ í‘œì‹œ (1~6ì )
  // GPIOA 0,1,2,3,4,5ë²ˆ ë¹„íŠ¸ ì‚¬ìš©
}
```

**updateLEDPattern()**
```cpp
void updateLEDPattern() {
  // ë¬¸ì œ LEDë¥¼ GPIOA 4,5,6,7ë²ˆ ë¹„íŠ¸ë¡œ ì œì–´
  // ledNumber 1~4ë¥¼ ë¹„íŠ¸ 4~7ë¡œ ë§¤í•‘
  uint8_t ledMask = 1 << (PROBLEM_LED_START_BIT + ledNumber - 1);
}
```

#### âœ¨ **ìƒˆë¡œìš´ í•¨ìˆ˜ë“¤**

**startClearDominoEffect()**
- ë„ë¯¸ë…¸ íš¨ê³¼ ìƒíƒœ ì´ˆê¸°í™”
- ì˜¤ë¦„ì°¨ìˆœë¶€í„° ì‹œì‘
- ëª¨ë“  ì ìˆ˜ LED ë„ê¸°

**updateClearDominoEffect()**
- 0.5ì´ˆ ê°„ê²©ìœ¼ë¡œ LED ìˆœì°¨ ì ë“±
- ì˜¤ë¦„ì°¨ìˆœ/ë‚´ë¦¼ì°¨ìˆœ ë°©í–¥ ì „í™˜
- 2íšŒ ì‚¬ì´í´ ì™„ë£Œ í›„ ëª¨ë“  LED ì ë“±

#### ğŸ”„ **ì—…ë°ì´íŠ¸ëœ ë¶€ë¶„**
- `loop()` í•¨ìˆ˜ì— `updateClearDominoEffect()` ì¶”ê°€
- `initializeStates()` í•¨ìˆ˜ì— ë„ë¯¸ë…¸ íš¨ê³¼ ìƒíƒœ ì´ˆê¸°í™” ì¶”ê°€
- `testLEDSystem()` í•¨ìˆ˜ì— ë„ë¯¸ë…¸ íš¨ê³¼ í…ŒìŠ¤íŠ¸ ì¶”ê°€

## âœ… **ì»´íŒŒì¼ ê²°ê³¼**
- **ìƒíƒœ**: ì„±ê³µ âœ…
- **RAM ì‚¬ìš©ëŸ‰**: 102.3% (2,096 / 2,048 bytes) âš ï¸ **ì´ˆê³¼**
- **Flash ì‚¬ìš©ëŸ‰**: 40.1% (12,324 / 30,720 bytes)

## âš ï¸ **ë©”ëª¨ë¦¬ ìµœì í™” í•„ìš”**
RAM ì‚¬ìš©ëŸ‰ì´ ì´ˆê³¼ë˜ì–´ ì¶”ê°€ ìµœì í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤:
1. ë¶ˆí•„ìš”í•œ ì „ì—­ ë³€ìˆ˜ ì œê±°
2. ë¬¸ìì—´ ìƒìˆ˜ë¥¼ PROGMEMìœ¼ë¡œ ì´ë™
3. êµ¬ì¡°ì²´ í¬ê¸° ìµœì í™”

## ğŸ¯ **ê¸°ëŠ¥ ìš”ì•½**

### âœ… **ì™„ë£Œëœ ê¸°ëŠ¥**
1. **ë¬¸ì œ LED**: GPIOA 4,5,6,7ë²ˆ ë¹„íŠ¸ë¡œ 4ê°œ LED ì œì–´
2. **ì ìˆ˜ LED**: GPIOA 0,1,2,3,4,5ë²ˆ ë¹„íŠ¸ë¡œ 6ê°œ LED ì œì–´
3. **ë„ë¯¸ë…¸ íš¨ê³¼**: 7ì  í´ë¦¬ì–´ ì‹œ 0.5ì´ˆ ê°„ê²© ì˜¤ë¦„ì°¨ìˆœ-ë‚´ë¦¼ì°¨ìˆœ 2íšŒ ë°˜ë³µ
4. **ë¹„íŠ¸ ë§¤í•‘**: ê° LED ê·¸ë£¹ì´ ë…ë¦½ì ì¸ ë¹„íŠ¸ ì˜ì—­ ì‚¬ìš©
5. **í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥**: LED í…ŒìŠ¤íŠ¸ì— ë„ë¯¸ë…¸ íš¨ê³¼ í¬í•¨

### ğŸ” **í…ŒìŠ¤íŠ¸ ë°©ë²•**
ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥:
```
led_test  // LED í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ë„ë¯¸ë…¸ íš¨ê³¼ í¬í•¨)
```

## ğŸŠ **ê²°ê³¼**
ìš”ì²­í•˜ì‹  LED ì„¤ì •ì´ ì™„ì „íˆ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤:
- âœ… ë¬¸ì œ LED: MCP23017 #1 GPIOA 4,5,6,7ë²ˆ ë¹„íŠ¸ (4ê°œ)
- âœ… ì ìˆ˜ LED: MCP23017 #2 GPIOA 0,1,2,3,4,5ë²ˆ ë¹„íŠ¸ (6ê°œ)
- âœ… 7ì  í´ë¦¬ì–´ ì‹œ ë„ë¯¸ë…¸ íš¨ê³¼: 0.5ì´ˆ ê°„ê²© ì˜¤ë¦„ì°¨ìˆœ-ë‚´ë¦¼ì°¨ìˆœ 2íšŒ ë°˜ë³µ

ë©”ëª¨ë¦¬ ìµœì í™”ë§Œ ì¶”ê°€ë¡œ ì§„í–‰í•˜ë©´ ì™„ë²½í•œ êµ¬í˜„ì´ ì™„ë£Œë©ë‹ˆë‹¤! ğŸ‰
</parameter>
</invoke>